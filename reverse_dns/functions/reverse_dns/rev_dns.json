{
  "id": "rev_dns",
  "conf": {
    "asyncFuncTimeout": 1000,
    "output": "default",
    "functions": [
      {
        "id": "eval",
        "filter": "__srcIpPort",
        "conf": {
          "add": [
            {
              "name": "__srcIpArr",
              "value": "__srcIpPort.split('|')"
            },
            {
              "name": "__srcProto",
              "value": "__srcIpArr[0]"
            },
            {
              "name": "__srcIp",
              "value": "__srcIpArr[1]"
            },
            {
              "name": "__srcPort",
              "value": "__srcIpArr[2]"
            }
          ],
          "remove": [
            "__srcIpArr"
          ]
        }
      },
      {
        "id": "reverse_dns",
        "filter": "__srcIp",
        "conf": {
          "fields": [
            {
              "inFieldName": "__srcIp",
              "outFieldName": "__srcDNS"
            }
          ],
          "cacheTTL": 60
        }
      },
      {
        "id": "lookup",
        "filter": "__srcIp",
        "conf": {
          "file": "subnets.csv",
          "matchMode": "cidr",
          "matchType": "first",
          "reloadPeriodSec": 60,
          "addToEvent": false,
          "inFields": [
            {
              "eventField": "__srcIp",
              "lookupField": "subnet"
            }
          ],
          "outFields": []
        }
      },
      {
        "id": "eval",
        "filter": "!subnet_name",
        "conf": {
          "add": [
            {
              "name": "subnet_name",
              "value": "'default'"
            }
          ]
        }
      }
    ]
  }
}
